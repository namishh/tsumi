{% extends "base.html" %}
{% block title %}index{% endblock title %}
{% block content %}
skibully toilet officer: {{name}}

<div contenteditable="true" class="">
  <h2>sadlfkj</h2>
</div>

<script>
  class Node {
    constructor(type, content = null, attrs = {}) {
      this.type = type;
      this.content = content;
      this.attrs = attrs;
      this.marks = [];
    }

    static text(text, marks = []) {
      const node = new Node("text", text);
      node.marks = marks;
      return node;
    }

    static paragraph(content = []) {
      return new Node("paragraph", content);
    }

    static heading(level, content = []) {
      return new Node("heading", content, { level });
    }

    static codeBlock(content = [], language = null) {
      const attrs = language ? { language } : {};
      return new Node("code_block", content, attrs);
    }

    static blockquote(content = []) {
      return new Node("blockquote", content);
    }

    static listItem(content = []) {
      return new Node("list_item", content);
    }

    static orderedList(content = []) {
      return new Node("ordered_list", content);
    }

    static bulletList(content = []) {
      return new Node("bullet_list", content);
    }

    static image(src, alt = "", title = "") {
      return new Node("image", null, { src, alt, title });
    }

    static horizontalRule() {
      return new Node("horizontal_rule");
    }

    isText() {
      return this.type === "text";
    }

    isBlock() {
      return ["paragraph", "heading", "code_block", "blockquote", "list_item", "ordered_list", "bullet_list", "horizontal_rule"].includes(this.type);
    }

    isInline() {
      return ["image"].includes(this.type);
    }

    textContent() {
      if (this.isText()) {
        return this.content || "";
      }

      if (Array.isArray(this.content)) {
        return this.content.map(child => child.textContent()).join("");
      }

      return "";
    }

    nodeSize() {
      if (this.isText()) {
        return (this.content || "").length;
      }

      if (Array.isArray(this.content)) {
        return this.content.reduce((size, child) => size + child.nodeSize(), 0);
      }

      return 0;
    }

    clone() {
      const cloned = new Node(this.type, null, { ...this.attrs });

      if (this.isText()) {
        cloned.content = this.content;
      } else if (Array.isArray(this.content)) {
        cloned.content = this.content.map(child => child.clone());
      }

      cloned.marks = [...this.marks];
      return cloned;
    }

    toJSON() {
      const json = {
        type: this.type
      };

      if (this.isText()) {
        json.text = this.content;
      } else if (Array.isArray(this.content)) {
        json.content = this.content.map(child => child.toJSON());
      }

      if (Object.keys(this.attrs).length > 0) {
        json.attrs = this.attrs;
      }

      if (this.marks.length > 0) {
        json.marks = this.marks.map(mark => mark.toJSON());
      }

      return json;
    }

    static fromJSON(json) {
      const node = new Node(json.type, null, json.attrs || {});

      if (json.text !== undefined) {
        node.content = json.text;
      } else if (json.content) {
        node.content = json.content.map(childJSON => Node.fromJSON(childJSON));
      }

      if (json.marks) {
        node.marks = json.marks.map(markJSON => Mark.fromJSON(markJSON));
      }

      return node;
    }
  }
</script>

{% endblock content%}